---
title: "Sevenr Project"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

## Introduction and data

Source, topic, when, how, cases, relevant variables

Ethical concerns?

Our research question is: "do the predictors of a linear regression modeling billionaire wealth change depending on if the wealth was inherited or not inherited?" That is, do the factors that are associated with higher levels of billionaire wealth change given that the billionaire had inherited money to begin with or not?

Our hypothesis is that ?

## Methodology

Multivariate linear regression.

Dataset cleaning (lots of 0s for some reason)

Model building

Other tools

## Results

Two (or more) linear regression models

```{r}
#| label: load-pkgs
#| message: false

library(tidyverse)
library(tidymodels)
```

```{r}
#| label: load-billion

billion <- read.csv("data/billionaires.csv")
glimpse(billion)
```

```{r}
#| label: Filtering-data

variable_filter <- billion |>
  filter(year == 2001) |>
  select(wealth.worth.in.billions, location.gdp, company.sector, demographics.age, wealth.how.inherited)

inheritance_grouping <- variable_filter |>
  mutate(inherited = if_else(str_detect(wealth.how.inherited, "not inherited"), "not inherited", "inherited"))

yes_inherited <- inheritance_grouping |>
  filter(inherited == "inherited")

not_inherited <- inheritance_grouping |>
  filter(inherited == "not inherited")
```

```{r}
#| label: location-regression

linear_reg() |>
  set_engine("lm") |>
  fit(wealth.worth.in.billions ~ location.gdp, data = variable_filter) |>
  tidy()
 
variable_filter |>
  ggplot(aes(x = location.gdp, y = wealth.worth.in.billions)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) 
 
linear_reg() |>
  set_engine("lm") |>
  fit(wealth.worth.in.billions ~ location.gdp, data = yes_inherited) |>
  tidy()
 
yes_inherited |>
  ggplot(aes(x = location.gdp, y = wealth.worth.in.billions)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) 

linear_reg() |>
  set_engine("lm") |>
  fit(wealth.worth.in.billions ~ location.gdp, data = not_inherited) |>
  tidy()
 
not_inherited |>
  ggplot(aes(x = location.gdp, y = wealth.worth.in.billions)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) 

```

```{r}
#| label: sector-regression

linear_reg() |>
  set_engine("lm") |>
  fit(wealth.worth.in.billions ~ company.sector, data = variable_filter) |>
  tidy()
 
variable_filter |>
  ggplot(aes(x = company.sector, y = wealth.worth.in.billions)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) 
 
linear_reg() |>
  set_engine("lm") |>
  fit(wealth.worth.in.billions ~ company.sector, data = yes_inherited) |>
  tidy()
 
yes_inherited |>
  ggplot(aes(x = company.sector, y = wealth.worth.in.billions)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) 
 
linear_reg() |>
  set_engine("lm") |>
  fit(wealth.worth.in.billions ~ company.sector, data = not_inherited) |>
  tidy()
 
not_inherited |>
  ggplot(aes(x = company.sector, y = wealth.worth.in.billions)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) 
```

```{r}
#| label: age-regression
 linear_reg() |>
    set_engine("lm") |>
    fit(wealth.worth.in.billions ~ demographics.age, data = variable_filter) |>
    tidy()
 
 variable_filter |>
    ggplot(aes(x = demographics.age, y = wealth.worth.in.billions)) +
    geom_point() +
    geom_smooth(method = "lm", se = F) 
 
linear_reg() |>
    set_engine("lm") |>
    fit(wealth.worth.in.billions ~ demographics.age, data = yes_inherited) |>
    tidy()
 
 yes_inherited |>
    ggplot(aes(x = demographics.age, y = wealth.worth.in.billions)) +
    geom_point() +
    geom_smooth(method = "lm", se = F) 
 
linear_reg() |>
  set_engine("lm") |>
  fit(wealth.worth.in.billions ~ demographics.age, data = not_inherited) |>
  tidy()
 
not_inherited |>
  ggplot(aes(x = demographics.age, y = wealth.worth.in.billions)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) 
```
